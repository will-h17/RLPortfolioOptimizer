run_name: "ppo_dirichlet_baseline"

seed: 123
paths:
  prices: "data/processed/prices_adj.parquet"
  features: "data/processed/features.parquet"
  out_root: "artifacts"          # all run folders will live under here

dates:
  train_end: "2019-12-31"
  val_end:   "2020-06-30"
  test_end:  "2021-03-31"

env:
  transaction_cost_bps: 0        # keep for backwrads compatability (unused when cost_model.enabled=true)
  include_cash: true
  cash_rate_annual: 0.02         # simple annualized cash rate (optional)
  normalize_obs_weights: true    # Better learning stability
  
  # Profitability-focused reward shaping
  reward_return_bonus: 1.5       # Bonus for positive returns (encourages profitability)
  reward_compound_bonus: 0.03    # Bonus for portfolio growth
  reward_vol_scaling: false      # Disable aggressive vol scaling (preserve returns)
  reward_sharpe_bonus: 0.005     # Small Sharpe bonus

reward:
  return_weight: 1.0
  turnover_penalty: 0.0002       # Small penalty to reduce excessive trading
  drawdown_penalty: 0.0          # optional, depends on our env design
  volatility_penalty: 0.0

ppo:
  learning_rate: 0.0002         # Slightly lower for stability
  gamma: 0.99
  gae_lambda: 0.95
  n_steps: 4096                  # More steps per update (better learning)
  batch_size: 512                 # Larger batches
  clip_range: 0.2
  ent_coef: 0.005                # Higher exploration
  policy_hidden_sizes: [256, 256, 128]  # Deeper network

hpo:
  train_timesteps: 300000

train:
  total_timesteps: 2000000       # 2M steps for better learning
  checkpoint_freq: 100000
  eval_freq: 50000

cost_model:
  enabled: true
  fee_bps: 0.0                    # explicit commissions/fees (per unit of notional turned over)
  slippage_bps: 0.0               # residual price impact not captured by spread
  spread:
    type: "vol20"                 # "fixed" | "vol20"
    fixed_bps: 2.0                # used only if type == "fixed"
    k_vol_to_bps: 4000.0          # Reduced costs during training (was 8000.0)
    vol_col_suffix: "_s20"        # feature column suffix for 20d rolling std of returns per asset (e.g., AAPL_s20)
